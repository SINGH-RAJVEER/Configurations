#!/bin/bash
STATE_FILE=~/.kbd_bright
LEVELS=("off" "low" "med" "high")

if [ ! -f "$STATE_FILE" ]; then
    echo "off" > "$STATE_FILE"
fi

CURRENT=$(cat "$STATE_FILE")

if [ "$1" = "toggle" ]; then
    for i in "${!LEVELS[@]}"; do
        if [ "${LEVELS[$i]}" = "$CURRENT" ]; then
            NEXT_INDEX=$(( (i + 1) % ${#LEVELS[@]} ))
            NEXT="${LEVELS[$NEXT_INDEX]}"
            break
        fi
    done
    ass -k "$NEXT"
    echo "$NEXT" > "$STATE_FILE"
elif [ "$1" = "get" ]; then
    ICON="ï„œ"
    echo "$ICON $CURRENT"
fi
